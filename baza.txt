//https://dbdiagram.io/d


//UsersCell
Table users {
  id integer [primary key]
  email varchar [unique, not null]
  password_hash varchar [not null]
  first_name varchar [not null]
  last_name varchar [not null]
  role_id integer [not null]
}

Table roles {
  id integer [primary key]
  name varchar [unique, not null] // Admin, User, Trainer
}

Ref: users.role_id > roles.id // many-to-one

//TrainingsCell
Table trainings {
  id integer [primary key]
  title varchar [not null]
  description text
  start_date datetime
  end_date datetime
  trainer_id integer [not null]
  trainer_email varchar [not null]
  training_type_id integer [not null]
  score_type varchar [note: 'kg, reps, time']
}

Table training_types {
  id integer [primary key]
  title varchar [not null]
  description text
}

Table training_type_memberships {
  id integer [primary key]
  user_id integer [not null]
  training_type_id integer [not null]
}

Table registrations {
  id integer [primary key]
  training_id integer [not null]
  user_id integer [not null]
  user_email varchar [not null]
  score varchar
}

Ref: registrations.training_id > trainings.id // many-to-one  
Ref: trainings.training_type_id > training_types.id
Ref: training_type_memberships.training_type_id > training_types.id
//Ref: training_type_memberships.user_id > users.id

//CompetitionsCell
Table competitions {
  id integer [primary key]
  title varchar [not null]
  description text
  start_date datetime
  end_date datetime
  location varchar
}

Table competition_memberships {
  id integer [primary key]
  competition_id integer [not null]
  user_id integer [not null]
  user_email varchar [not null]
}

Table workouts {
  id integer [primary key]
  title varchar [not null]
  description text
  competition_id integer [not null]
  score_type varchar [note: 'kg, reps, time']
}

Table results {
  id integer [primary key]
  workout_id integer [not null]
  user_id integer [not null]
  user_email varchar
  score varchar
}

Ref: competition_memberships.competition_id > competitions.id // many-to-one  
Ref: results.workout_id > workouts.id // many-to-one  
Ref: workouts.competition_id > competitions.id // many-to-one  


//NotificationsCell
Table notifications {
  id integer [primary key]
  user_id integer [not null]
  user_email varchar [not null]
  message text
}
//Ref: notifications.user_id > users.id // many-to-one (preko sinkronizacije putem dogaÄ‘aja)

//PaymentsCell
Table CompetitionsPayments {
  id integer [primary key]
  user_id integer [not null]
  competition_id integer [not null]
  user_email varchar [not null]
  price float [not null]
  tax float [not null]
  total float [not null]
}

//Ref: payments.user_id > users.id // many-to-one (preko sinkronizacije putem dogaÄ‘aja)

//Media
Table media {
  id integer [primary key]
  related_id integer [not null] // Reference to user, training, or competition
  entity_type varchar [not null] // user, training, competition
  media_type varchar [not null] // Image, Video
  url varchar [not null]
}

//Ref: media.related_id > trainings.id // many-to-one  
//Ref: media.related_id > competitions.id // many-to-one  
//Ref: media.related_id > users.id // many-to-one  

